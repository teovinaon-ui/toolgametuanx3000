<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TOOL GAME V6.1 - DEEP LEARNING</title>
    <style>
        /* --- GIAO DI·ªÜN DARK MODE HACKER --- */
        body { background-color: #050505; color: #00ff41; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; overflow: hidden; }
        * { box-sizing: border-box; user-select: none; }
        #game-frame { display: none; width: 100%; height: 100vh; border: none; z-index: 1; position: absolute; top: 0; left: 0; }
        
        .container { position: relative; z-index: 10; max-width: 450px; margin: 0 auto; padding: 20px; height: 100vh; display: flex; flex-direction: column; background: radial-gradient(circle at center, #1a1a1a 0%, #000 100%); }
        
        .header { text-align: center; margin-bottom: 20px; animation: fadeIn 1s ease; }
        .google-badge { background: #fff; color: #444; font-weight: bold; font-size: 10px; padding: 2px 8px; border-radius: 4px; display: inline-block; margin-bottom: 5px; }
        h1 { margin: 0; color: #00ff41; text-shadow: 0 0 15px rgba(0, 255, 65, 0.5); font-size: 28px; text-transform: uppercase; }
        
        .notif-bar { background: rgba(255, 0, 170, 0.1); border: 1px solid #ff00aa; color: #ff00aa; padding: 10px; border-radius: 8px; margin-bottom: 20px; font-size: 12px; font-weight: bold; text-align: center; animation: pulse 2s infinite; cursor: pointer; }
        
        .auth-tabs { display: flex; border-bottom: 1px solid #333; margin-bottom: 20px; }
        .tab-btn { flex: 1; padding: 12px; background: transparent; border: none; color: #666; font-weight: bold; cursor: pointer; transition: 0.3s; border-bottom: 2px solid transparent; }
        .tab-btn.active { color: #00ff41; border-bottom: 2px solid #00ff41; }
        
        .form-group { display: none; animation: slideUp 0.5s ease; }
        .form-group.active { display: block; }
        input { width: 100%; padding: 14px; margin: 8px 0; background: #111; border: 1px solid #333; color: #fff; border-radius: 8px; outline: none; transition: 0.3s; text-align: center; }
        input:focus { border-color: #00ff41; box-shadow: 0 0 10px rgba(0, 255, 65, 0.2); }
        
        .btn-submit { width: 100%; padding: 15px; margin-top: 15px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 16px; text-transform: uppercase; }
        .btn-login { background: linear-gradient(90deg, #008000, #00ff41); color: #000; }
        .btn-reg { background: linear-gradient(90deg, #333, #555); color: #fff; }
        
        #game-select-screen { display: none; }
        .game-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .game-card { background: #111; border: 1px solid #333; border-radius: 12px; padding: 20px; text-align: center; cursor: pointer; transition: 0.3s; position: relative; overflow: hidden; }
        .game-card:hover { border-color: #ff00aa; transform: translateY(-5px); }
        .game-card h3 { margin: 10px 0 0; font-size: 14px; color: #fff; }
        .game-icon { font-size: 30px; }
        
        #key-screen { display: none; text-align: center; }
        
        /* MINI TOOL */
        #mini-tool { display: none; position: fixed; top: 120px; left: 20px; width: 220px; background: rgba(0, 0, 0, 0.95); border: 1px solid #00ff41; border-radius: 15px; padding: 15px; text-align: center; z-index: 9999; box-shadow: 0 0 25px rgba(0, 255, 65, 0.3); }
        .tool-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; padding-bottom: 5px; margin-bottom: 10px; }
        .gg-logo { font-size: 10px; font-weight: bold; color: #fff; display: flex; align-items: center; gap: 5px; }
        .gg-circle { width: 8px; height: 8px; background: #EA4335; border-radius: 50%; }
        
        #prediction { font-size: 48px; font-weight: 900; margin: 5px 0; color: #fff; }
        #log-area { font-size: 9px; color: #00ff41; font-family: monospace; text-align: left; height: 30px; overflow: hidden; opacity: 0.8; }
        #win-rate { font-size: 14px; font-weight: bold; margin-top: 5px; color: #ff0; }
        
        .status-badge { font-size: 9px; padding: 2px 6px; border-radius: 4px; color: #000; font-weight: bold; }
        .st-calib { background: #ffaa00; }
        .st-ready { background: #00ff41; }
        .st-danger { background: #ff0044; color: #fff; }
        
        .tele-float { position: fixed; bottom: 20px; right: 20px; z-index: 99999; background: #0088cc; color: white; padding: 12px 20px; border-radius: 50px; text-decoration: none; font-weight: bold; display: flex; align-items: center; gap: 10px; box-shadow: 0 5px 20px rgba(0, 136, 204, 0.5); animation: float 3s ease-in-out infinite; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 0, 170, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(255, 0, 170, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 0, 170, 0); } }
        @keyframes float { 0% { transform: translateY(0); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="container" id="main-ui">
        <div class="header">
            <span class="google-badge">Powered by Google Cloud AI</span>
            <h1>TOOL GAME V6.1</h1>
            <p style="font-size: 10px; color: #666; margin-top: 5px;">DEEP LEARNING CORE Tuanx3000 PROCESSING</p>
        </div>

        <div class="notif-bar" onclick="window.location.href='https://t.me/tuanx3000'">
            üì¢ MUA KEY VIP LI√äN H·ªÜ TELEGRAM: @TUANX3000 
        </div>

        <div id="auth-screen">
            <div class="auth-tabs">
                <button class="tab-btn active" onclick="switchTab('login')">ƒêƒÇNG NH·∫¨P</button>
                <button class="tab-btn" onclick="switchTab('register')">ƒêƒÇNG K√ù</button>
            </div>
            <div id="login-form" class="form-group active">
                <input type="text" id="login-user" placeholder="T√™n t√†i kho·∫£n">
                <input type="password" id="login-pass" placeholder="M·∫≠t kh·∫©u">
                <button class="btn-submit btn-login" onclick="handleLogin()">V√ÄO H·ªÜ TH·ªêNG</button>
            </div>
            <div id="reg-form" class="form-group">
                <input type="text" id="reg-user" placeholder="T√™n t√†i kho·∫£n m·ªõi">
                <input type="password" id="reg-pass" placeholder="M·∫≠t kh·∫©u m·ªõi">
                <input type="password" id="reg-repass" placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u">
                <button class="btn-submit btn-reg" onclick="handleRegister()">ƒêƒÇNG K√ù NGAY</button>
                <p style="font-size: 10px; color:#666; margin-top:10px;">*T√†i kho·∫£n s·∫Ω ƒë∆∞·ª£c l∆∞u tr√™n Google Database.</p>
            </div>
        </div>

        <div id="game-select-screen">
            <h3 style="color:#fff; text-align:center;">CH·ªåN C·ªîNG GAME</h3>
            <div class="game-grid">
                <div class="game-card" onclick="selectGame('sunwin')">
                    <div class="game-icon">üî¥</div>
                    <h3>SUNWIN</h3>
                    <div style="font-size:9px; color:#0f0; margin-top:5px;">‚óè Online</div>
                </div>
                <div class="game-card" onclick="selectGame('go88')">
                    <div class="game-icon">üü°</div>
                    <h3>GO88</h3>
                    <div style="font-size:9px; color:#666; margin-top:5px;">‚óè B·∫£o tr√¨</div>
                </div>
                <div class="game-card" onclick="selectGame('789')">
                    <div class="game-icon">üü£</div>
                    <h3>789 CLUB</h3>
                    <div style="font-size:9px; color:#666; margin-top:5px;">‚óè B·∫£o tr√¨</div>
                </div>
                <div class="game-card" onclick="selectGame('rik')">
                    <div class="game-icon">üîµ</div>
                    <h3>RIKVIP</h3>
                    <div style="font-size:9px; color:#666; margin-top:5px;">‚óè B·∫£o tr√¨</div>
                </div>
            </div>
            <button class="btn-submit btn-reg" style="margin-top:20px;" onclick="location.reload()">QUAY L·∫†I</button>
        </div>

        <div id="key-screen">
            <h3 style="color:#fff;">X√ÅC TH·ª∞C B·∫¢O M·∫¨T</h3>
            <p style="font-size:12px; color:#666;">Vui l√≤ng nh·∫≠p Key VIP ƒë√£ mua t·ª´ Admin</p>
            <input type="text" id="key-input" placeholder="KEY-XXXX-XXXX" style="letter-spacing: 2px;">
            <button class="btn-submit btn-login" onclick="verifyKey()">K√çCH HO·∫†T & CH·∫†Y TOOL</button>
            <p style="font-size:11px; color:#ff00aa; margin-top:15px; cursor:pointer;" onclick="window.location.href='https://t.me/tuanx3000'">Ch∆∞a c√≥ Key? Mua t·∫°i ƒë√¢y</p>
        </div>
    </div>

    <a href="https://t.me/tuanx3000" class="tele-float" id="tele-btn">
        <span>‚úàÔ∏è</span> ADMIN TUANX3000
    </a>

    <iframe id="game-frame"></iframe>

    <div id="mini-tool">
        <div class="tool-header">
            <div class="gg-logo"><div class="gg-circle"></div> Google AI Deep</div>
            <div id="status-badge" class="status-badge st-calib">INITIALIZING</div>
        </div>
        <div id="log-area">Wait for next session...</div>
        <div id="prediction">WAIT</div>
        <div id="win-rate">---</div>
        <div style="font-size: 8px; color: #444; margin-top: 5px;">NEXT SESSION: <span id="session-id">...</span></div>
    </div>

    <script>
        // *** ƒê√É C·∫¨P NH·∫¨T LINK SCRIPT C·ª¶A B·∫†N T·∫†I ƒê√ÇY ***
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycby8XkEuyhuOc5AOyoI3P3aJqLXMUEJbawBMIG2WyybQX-mg1MMgCakU_dpXRuSNEkrJ3Q/exec";
        
        let currentUser = null;
        let selectedGame = "";
        let history = [];
        let sessionCount = 0;
        let lastSession = "";

        // UI Functions
        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.form-group').forEach(f => f.classList.remove('active'));
            if(tab === 'login') {
                document.querySelectorAll('.tab-btn')[0].classList.add('active');
                document.getElementById('login-form').classList.add('active');
            } else {
                document.querySelectorAll('.tab-btn')[1].classList.add('active');
                document.getElementById('reg-form').classList.add('active');
            }
        }

        async function handleRegister() {
            const u = document.getElementById('reg-user').value;
            const p = document.getElementById('reg-pass').value;
            const rp = document.getElementById('reg-repass').value;
            if (!u || !p) return alert("Nh·∫≠p ƒë·ªß th√¥ng tin!");
            if (p !== rp) return alert("M·∫≠t kh·∫©u kh√¥ng kh·ªõp!");
            
            // G·ª≠i d·ªØ li·ªáu ƒëƒÉng k√Ω l√™n Script
            try {
                const res = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', // Google Script th∆∞·ªùng y√™u c·∫ßu no-cors n·∫øu g·ªçi t·ª´ domain kh√°c
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({action: 'register', user: u, pass: p})
                });
                alert("ƒêƒÉng k√Ω th√†nh c√¥ng! H√£y IB Admin @tuanx3000 ƒê·ªÇ MUA KEY.");
                switchTab('login');
            } catch(e) {
                alert("L·ªói k·∫øt n·ªëi! Vui l√≤ng th·ª≠ l·∫°i.");
            }
        }

        async function handleLogin() {
            const u = document.getElementById('login-user').value;
            const p = document.getElementById('login-pass').value;
            if(!u || !p) return alert("Ch∆∞a nh·∫≠p t√†i kho·∫£n/m·∫≠t kh·∫©u!");
            document.querySelector('.btn-login').innerText = "ƒêANG K·∫æT N·ªêI...";
            
            try {
                const res = await fetch(SCRIPT_URL);
                const data = await res.json();
                // Gi·∫£ ƒë·ªãnh Script tr·∫£ v·ªÅ m·∫£ng 2 chi·ªÅu [[user, pass, key, exp], ...]
                const userRow = data.slice(1).find(r => r[0] == u && r[1] == p);
                if (userRow) {
                    currentUser = userRow;
                    document.getElementById('auth-screen').style.display = 'none';
                    document.getElementById('game-select-screen').style.display = 'block';
                } else {
                    alert("Sai t√†i kho·∫£n ho·∫∑c m·∫≠t kh·∫©u!");
                    document.querySelector('.btn-login').innerText = "V√ÄO H·ªÜ TH·ªêNG";
                }
            } catch (e) {
                alert("L·ªói t·∫£i d·ªØ li·ªáu t·ª´ Google!");
                document.querySelector('.btn-login').innerText = "V√ÄO H·ªÜ TH·ªêNG";
            }
        }

        function selectGame(game) {
            if (game !== 'sunwin') return alert("ƒêANG B·∫¢O TR√å MUA KEY ·ª¶NG H·ªò AD!");
            selectedGame = game;
            document.getElementById('game-select-screen').style.display = 'none';
            document.getElementById('key-screen').style.display = 'block';
        }

        function verifyKey() {
            if (!currentUser) return alert("L·ªói phi√™n!");
            const k = document.getElementById('key-input').value.trim();
            // C·ªôt C l√† Key (index 2)
            if (k === currentUser[2]) {
                document.getElementById('main-ui').style.display = 'none';
                document.getElementById('tele-btn').style.display = 'none';
                document.getElementById('game-frame').src = "https://web.sunwin.bi";
                document.getElementById('game-frame').style.display = 'block';
                document.getElementById('mini-tool').style.display = 'block';
                setInterval(runCoreAI, 3000);
            } else alert("Key kh√¥ng ƒë√∫ng ho·∫∑c ch∆∞a k√≠ch ho·∫°t!");
        }

        // --- CORE AI V6.1: T√çNH TO√ÅN 25 GI√ÇY & AUTO +1 ---
        async function runCoreAI() {
            const proxy = 'https://api.allorigins.win/get?url=';
            const api = 'https://sunwinsaygex-vd0m.onrender.com/api/sun';

            try {
                const res = await fetch(`${proxy}${encodeURIComponent(api + '?t=' + Date.now())}`);
                const json = await res.json();
                const data = JSON.parse(json.contents);

                if (data && data.phien && data.phien !== lastSession) {
                    lastSession = data.phien;
                    sessionCount++;
                    
                    // C·∫¨P NH·∫¨T PHI√äN AUTO +1
                    const nextSession = parseInt(data.phien) + 1;
                    document.getElementById('session-id').innerText = nextSession;

                    const predEl = document.getElementById('prediction');
                    const logEl = document.getElementById('log-area');
                    const rateEl = document.getElementById('win-rate');
                    const statusEl = document.getElementById('status-badge');

                    // RESET GIAO DI·ªÜN
                    predEl.innerText = "SCAN";
                    predEl.style.color = "#444";
                    rateEl.innerText = "ƒêang ph√¢n t√≠ch...";
                    statusEl.innerText = "PROCESSING";
                    statusEl.className = "status-badge st-ready";

                    if (data.ketqua) {
                        history.push(data.ketqua);
                        if(history.length > 20) history.shift();
                    }

                    // D√í C·∫¶U (2 V√ÅN ƒê·∫¶U)
                    if (sessionCount <= 2) {
                        statusEl.innerText = "CALIBRATING";
                        statusEl.className = "status-badge st-calib";
                        predEl.innerText = "SKIP";
                        predEl.style.color = "#666";
                        logEl.innerText = `‚óè ƒêang ƒë·ªìng b·ªô nh·ªãp c·∫ßu (${sessionCount}/2)...`;
                        return;
                    }

                    // --- QUY TR√åNH T√çNH TO√ÅN 25 GI√ÇY ---
                    const logs = [
                        "‚óè Phase 1: Ingesting Session Data #" + nextSession,
                        "‚óè Phase 2: Decrypting MD5 Hash...",
                        "‚óè Phase 3: Analyzing Historical Matrix (12 steps)...",
                        "‚óè Phase 4: Checking Volatility Index...",
                        "‚óè Phase 5: Detecting Anti-Bot Patterns...",
                        "‚óè Phase 6: Calculating Weighted Probability...",
                        "‚óè Finalizing Prediction..."
                    ];

                    let step = 0;
                    const logTimer = setInterval(() => {
                        if(step < logs.length) {
                            logEl.innerText = logs[step];
                            step++;
                        } else clearInterval(logTimer);
                    }, 3500);

                    // HI·ªÇN TH·ªä K·∫æT QU·∫¢ SAU 25s
                    setTimeout(() => {
                        let result = "";
                        let confidence = 0;
                        const lastResult = history[history.length - 1]; 

                        // LOGIC
                        let streak = 0;
                        for (let i = history.length - 1; i >= 0; i--) {
                            if (history[i] === lastResult) streak++;
                            else break;
                        }

                        let isPingPong = false;
                        if (history.length >= 4) {
                            const h = history;
                            const len = h.length;
                            if (h[len-1] != h[len-2] && h[len-2] != h[len-3] && h[len-3] != h[len-4]) isPingPong = true;
                        }

                        // QUY·∫æT ƒê·ªäNH
                        if (streak >= 4) {
                            if (streak > 6) {
                                result = lastResult; // B·ªát ti·∫øp
                                confidence = 89;
                                logEl.innerText = "‚óè PATTERN: B·ªát si√™u tr∆∞·ªùng (Long Streak).";
                            } else {
                                result = (lastResult === "T√ÄI") ? "X·ªàU" : "T√ÄI"; // B·∫ª
                                confidence = 78; 
                                logEl.innerText = "‚óè PATTERN: ƒêi·ªÉm g√£y c·∫ßu b·ªát (Break Point).";
                            }
                        } else if (isPingPong) {
                            result = (lastResult === "T√ÄI") ? "X·ªàU" : "T√ÄI";
                            confidence = 92;
                            logEl.innerText = "‚óè PATTERN: C·∫ßu chuy·ªÅn 1-1 (Ping Pong).";
                        } else {
                            const countTai = history.filter(x => x === "T√ÄI").length;
                            const countXiu = history.filter(x => x === "X·ªàU").length;
                            if (countTai > countXiu) {
                                result = "X·ªàU";
                                logEl.innerText = "‚óè BALANCE: C√¢n b·∫±ng c·ª≠a X·ªâu.";
                            } else {
                                result = "T√ÄI";
                                logEl.innerText = "‚óè BALANCE: C√¢n b·∫±ng c·ª≠a T√†i.";
                            }
                            confidence = Math.floor(Math.random() * (85 - 80 + 1)) + 80;
                        }

                        // KILL SWITCH
                        if (Math.random() > 0.85) {
                            predEl.innerText = "B·ªé";
                            predEl.style.color = "#ff0044";
                            rateEl.innerText = "R·ªßi ro cao - Kh√¥ng v√†o ti·ªÅn";
                            logEl.innerText = "‚óè ALERT: D·ªØ li·ªáu nhi·ªÖu (Noise Detected).";
                            statusEl.className = "status-badge st-danger";
                            statusEl.innerText = "UNSAFE";
                        } else {
                            predEl.innerText = result;
                            predEl.style.color = (result === "T√ÄI") ? "#ff4d4d" : "#00ff41";
                            rateEl.innerText = `ƒê·ªô tin c·∫≠y: ${confidence}%`;
                            statusEl.innerText = "COMPLETED";
                        }

                    }, 25000); // 25s
                }
            } catch (e) {}
        }

        const t = document.getElementById('mini-tool');
        let d = false, sx, sy;
        t.addEventListener('touchstart', e => { d=true; sx=e.touches[0].clientX-t.offsetLeft; sy=e.touches[0].clientY-t.offsetTop; });
        document.addEventListener('touchmove', e => { if(d){ t.style.left=(e.touches[0].clientX-sx)+'px'; t.style.top=(e.touches[0].clientY-sy)+'px'; }});
        document.addEventListener('touchend', () => d=false);
    </script>
</body>
</html>
